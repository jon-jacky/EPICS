
record(calc, "Iso:FilterWedge:WedgeType:Encode") {
  field(DESC, "WEDGE TYPE")
  field(INPA, "Iso:FilterWedge:WedgeTypeNone:Achieved")
  field(INPB, "Iso:FilterWedge:WedgeType30:Achieved")
  field(INPC, "Iso:FilterWedge:WedgeType45:Achieved")
  field(INPD, "Iso:FilterWedge:WedgeType60:Achieved")
  field(CALC, "A?0:B?1:C?2:D?3:4") # 40 char limit
  field(FLNK, "Iso:FilterWedge:WedgeType:Actual")
}


record(mbbo, "Iso:FilterWedge:WedgeType:Prescribed") {
  field(DESC, "WEDGE TYPE")
  field(ZRST, "NONE")
  field(ONST, "30 deg")
  field(TWST, "45 deg")
  field(THST, "60 deg")
  field(FRST, "***")
  field(FVST, "INVALID")
  field(FLNK, "Iso:FilterWedge:WedgeType:Calc")
}


record(mbbo, "Iso:FilterWedge:WedgeType:Actual") {
  field(DESC, "WEDGE TYPE")
  field(ZRST, "NONE")
  field(ONST, "30 deg")
  field(TWST, "45 deg")
  field(THST, "60 deg")
  field(FRST, "***")
  field(FVST, "INVALID")
  field(DOL, "Iso:FilterWedge:WedgeType:Encode") 
  field(OMSL, "closed_loop") # needed for DOL
  field(FLNK, "Iso:FilterWedge:WedgeType:Calc")
}


record(calc, "Iso:FilterWedge:WedgeType:Calc"){
  field(INPA, "Iso:FilterWedge:WedgeType:Prescribed")
  field(INPB, "Iso:FilterWedge:WedgeType:Actual")
  field(CALC, "(A=B)?2:0")

  field(FLNK, "Iso:FilterWedge:WedgeType:CalcOverride")
}

record(bo, "Iso:FilterWedge:WedgeType:Override"){
  field(ZNAM, "Not overridden")
  field(ONAM, "Overridden")
  field(FLNK, "Iso:FilterWedge:WedgeType:CalcOverride")
}

# needed because in :Calc, CALC might be too long to include :Override 
record(calc, "Iso:FilterWedge:WedgeType:CalcOverride"){
  field(INPA, "Iso:FilterWedge:WedgeType:Calc")
  field(INPB, "Iso:FilterWedge:WedgeType:Override")
  field(CALC, "B?1:A")
  field(FLNK, "Iso:FilterWedge:WedgeType:Readiness")
}


record(mbbo, "Iso:FilterWedge:WedgeType:Readiness") {
  field(DESC, "WEDGE TYPE")
  field(VAL, "0")  # initially NOT READY
  field(ZRST, "NOT READY")
  field(ONST, "OVERRIDE")
  field(TWST, "READY")
  field(DOL, "Iso:FilterWedge:WedgeType:CalcOverride") 
  field(OMSL, "closed_loop") # needed for DOL
field(FLNK,  "Iso:FilterWedge:Settings:Readiness")
}


record(calc, "Iso:FilterWedge:WedgeRot:Encode") {
  field(DESC, "WEDGE ROT")
  field(INPA, "Iso:FilterWedge:WedgeRot0:Achieved")
  field(INPB, "Iso:FilterWedge:WedgeRot90:Achieved")
  field(INPC, "Iso:FilterWedge:WedgeRot180:Achieved")
  field(INPD, "Iso:FilterWedge:WedgeRot270:Achieved")
  field(CALC, "A?0:B?1:C?2:D?3:4") # 40 char limit
  field(FLNK, "Iso:FilterWedge:WedgeRot:Actual")
}


record(mbbo, "Iso:FilterWedge:WedgeRot:Prescribed") {
  field(DESC, "WEDGE ROT")
  field(ZRST, "  0 deg")
  field(ONST, " 90 deg")
  field(TWST, "180 deg")
  field(THST, "270 deg")
  field(FRST, "***")
  field(FVST, "INVALID")
  field(FLNK, "Iso:FilterWedge:WedgeRot:Calc")
}


record(mbbo, "Iso:FilterWedge:WedgeRot:Actual") {
  field(DESC, "WEDGE ROT")
  field(ZRST, "  0 deg")
  field(ONST, " 90 deg")
  field(TWST, "180 deg")
  field(THST, "270 deg")
  field(FRST, "***")
  field(FVST, "INVALID")
  field(DOL, "Iso:FilterWedge:WedgeRot:Encode") 
  field(OMSL, "closed_loop") # needed for DOL
  field(FLNK, "Iso:FilterWedge:WedgeRot:Calc")
}


record(calc, "Iso:FilterWedge:WedgeRot:Calc"){
  field(INPA, "Iso:FilterWedge:WedgeRot:Prescribed")
  field(INPB, "Iso:FilterWedge:WedgeRot:Actual")
  field(CALC, "(A=B)?2:0")

  field(FLNK, "Iso:FilterWedge:WedgeRot:CalcOverride")
}

record(bo, "Iso:FilterWedge:WedgeRot:Override"){
  field(ZNAM, "Not overridden")
  field(ONAM, "Overridden")
  field(FLNK, "Iso:FilterWedge:WedgeRot:CalcOverride")
}

# needed because in :Calc, CALC might be too long to include :Override 
record(calc, "Iso:FilterWedge:WedgeRot:CalcOverride"){
  field(INPA, "Iso:FilterWedge:WedgeRot:Calc")
  field(INPB, "Iso:FilterWedge:WedgeRot:Override")
  field(CALC, "B?1:A")
  field(FLNK, "Iso:FilterWedge:WedgeRot:Readiness")
}


record(mbbo, "Iso:FilterWedge:WedgeRot:Readiness") {
  field(DESC, "WEDGE ROT")
  field(VAL, "0")  # initially NOT READY
  field(ZRST, "NOT READY")
  field(ONST, "OVERRIDE")
  field(TWST, "READY")
  field(DOL, "Iso:FilterWedge:WedgeRot:CalcOverride") 
  field(OMSL, "closed_loop") # needed for DOL
field(FLNK,  "Iso:FilterWedge:Settings:Readiness")
}


record(calc, "Iso:FilterWedge:FlatFilter:Encode") {
  field(DESC, "FILTER")
  field(INPA, "Iso:FilterWedge:FlatFilterNone:Achieved")
  field(INPB, "Iso:FilterWedge:FlatFilterLarge:Achieved")
  field(INPC, "Iso:FilterWedge:FlatFilterSmall:Achieved")
  field(INPD, "Iso:FilterWedge:Placeholder:Achieved")
  field(CALC, "A?0:B?1:C?2:3") # 40 char limit
  field(FLNK, "Iso:FilterWedge:FlatFilter:Actual")
}


record(mbbo, "Iso:FilterWedge:FlatFilter:Prescribed") {
  field(DESC, "FILTER")
  field(ZRST, "NONE")
  field(ONST, "LARGE")
  field(TWST, "SMALL")
  field(THST, "***")
  field(FRST, "Placeholder")
  field(FVST, "INVALID")
  field(FLNK, "Iso:FilterWedge:FlatFilter:Calc")
}


record(mbbo, "Iso:FilterWedge:FlatFilter:Actual") {
  field(DESC, "FILTER")
  field(ZRST, "NONE")
  field(ONST, "LARGE")
  field(TWST, "SMALL")
  field(THST, "***")
  field(FRST, "Placeholder")
  field(FVST, "INVALID")
  field(DOL, "Iso:FilterWedge:FlatFilter:Encode") 
  field(OMSL, "closed_loop") # needed for DOL
  field(FLNK, "Iso:FilterWedge:FlatFilter:Calc")
}


record(calc, "Iso:FilterWedge:FlatFilter:Calc"){
  field(INPA, "Iso:FilterWedge:FlatFilter:Prescribed")
  field(INPB, "Iso:FilterWedge:FlatFilter:Actual")
  field(CALC, "(A=B)?2:0")

  field(FLNK, "Iso:FilterWedge:FlatFilter:CalcOverride")
}

record(bo, "Iso:FilterWedge:FlatFilter:Override"){
  field(ZNAM, "Not overridden")
  field(ONAM, "Overridden")
  field(FLNK, "Iso:FilterWedge:FlatFilter:CalcOverride")
}

# needed because in :Calc, CALC might be too long to include :Override 
record(calc, "Iso:FilterWedge:FlatFilter:CalcOverride"){
  field(INPA, "Iso:FilterWedge:FlatFilter:Calc")
  field(INPB, "Iso:FilterWedge:FlatFilter:Override")
  field(CALC, "B?1:A")
  field(FLNK, "Iso:FilterWedge:FlatFilter:Readiness")
}


record(mbbo, "Iso:FilterWedge:FlatFilter:Readiness") {
  field(DESC, "FILTER")
  field(VAL, "0")  # initially NOT READY
  field(ZRST, "NOT READY")
  field(ONST, "OVERRIDE")
  field(TWST, "READY")
  field(DOL, "Iso:FilterWedge:FlatFilter:CalcOverride") 
  field(OMSL, "closed_loop") # needed for DOL
field(FLNK,  "Iso:FilterWedge:Settings:Readiness")
}

